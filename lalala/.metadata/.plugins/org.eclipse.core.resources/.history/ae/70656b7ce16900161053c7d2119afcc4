import java.sql.*;
public class Db01 {
	public static void main(String args[]){
		Connection connect = null;
		Statement state = null;
		try{
			Class.forName("sun.jdbc.odbc.JdbcOdbcDriver");			
			connect = DriverManager.getConnection("jdbc:odbc:SQL server", "sa", "321wssba");
			state = connect.createStatement();
//			/*添加 返回受影响的行数*/
//			int i = state.executeUpdate("insert into charactor values(1,'刘备','国君','男',10000,1000)");
//			if(i==1){
//				System.out.println("添加成功");
//			}
			
//			/*删除 返回受影响的行数*/
//			int i1 = state.executeUpdate("delete from charactor where id =1");
//			if(i1!=0){
//				System.out.println("删除成功");
//			}
//			else{
//				System.out.println("删除失败");
//			}
			/*删除 返回受影响的行数*/
			int i2 = state.executeUpdate("update charactor set salary = salary*1.02 where salary>7000 or id =1");
			if(i2!=0){
				System.out.println("修改成功");
			}
			else{
				System.out.println("修改失败");
			}
			
			ResultSet rs = state.executeQuery("select * from charactor");//SQL语句
			
			while(rs.next()){//rs指向的事第一行的下一行
				int id = rs.getInt(1);//得到第一个字段
				String name = rs.getString(2);
				String occupation = rs.getString(3);
				System.out.println(id + " "+name + " "+occupation);
			}
		}
		catch(Exception e){}
	}
}
